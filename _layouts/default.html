<!DOCTYPE html>
<html lang="en">
<!-- Template: Modern Dark Theme -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    {% if page.title ==  site.data.profile.navbar_name %}
    <title>{{ page.title }}</title>
    {% else %}
    <title>{{ page.title }} - {{ site.data.profile.navbar_name }}</title>
    {% endif %}
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="shortcut icon" href="/assets/images/favicon/favicon.ico">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#0284c7">
    <meta name="background-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Romel Portfolio">
    <meta name="application-name" content="Romel Portfolio">
    <meta name="msapplication-TileColor" content="#0284c7">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- iOS Splash Screens -->
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
    <link rel="apple-touch-startup-image" href="/assets/images/splash/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" integrity="sha512-P5MgMn1jBN01asBgU0z60Qk4QxiXo86+wlFahKrsQf37c9cro517WzVSPPV1tDKzhku2iJ2FVgL67wG03SGnNA==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css" integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin="anonymous" />
    
    <!-- Animation Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" integrity="sha512-c42qTSw/wPZ3/5LBzD+Bw5f7bSF2oxou6wEb+I/lqeaKV5FDIfMvvRp772y4jcJLKuGUOpbJMdg/BTl50fJYAw==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" integrity="sha512-1cK78a1o+ht2JcaW6g8OXYwqpev9+6GqOkz9xmBN9iUUhIndKtxwILGWYOSibOKjLsEdjyjZvYDq/cZwNeak0w==" crossorigin="anonymous" />
    
    <!-- Pace.js Loading Animation -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.min.css" integrity="sha512-kKWqpi6bvuw3MOGPCMBqNkdJWSi5j/gkXaU/kTE8Q7+y6dqhsRYa+rHbG5sFOqMnGW5zZOxdPfnPyxLxUbVPCw==" crossorigin="anonymous" />
    
    <!-- Modern Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Preload critical CSS files -->
    <link rel="preload" href="{{ '/assets/css/global.css' | relative_url }}" as="style">
    <link rel="preload" href="{{ '/assets/css/developer-theme.css' | relative_url }}" as="style">
    
    <!-- Critical CSS files -->
    <link rel="stylesheet" href="{{ '/assets/css/global.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/developer-theme.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/responsive-images.css' | relative_url }}">
    
    <!-- Non-critical CSS loaded asynchronously -->
    <link rel="preload" href="{{ '/assets/css/enhanced-animations.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="{{ '/assets/css/advanced-interactions.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="{{ '/assets/css/search.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="{{ '/assets/css/syntax-highlighting.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- Fallback for browsers without preload support -->
    <noscript>
        <link rel="stylesheet" href="{{ '/assets/css/enhanced-animations.css' | relative_url }}">
        <link rel="stylesheet" href="{{ '/assets/css/advanced-interactions.css' | relative_url }}">
        <link rel="stylesheet" href="{{ '/assets/css/search.css' | relative_url }}">
        <link rel="stylesheet" href="{{ '/assets/css/syntax-highlighting.css' | relative_url }}">
    </noscript>
    
    <!-- Critical CSS inline for faster rendering -->
    {% include critical-css.html %}
    
    <!-- Theme initialization script to prevent FOUC -->
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 'dark';
            document.documentElement.classList.add(theme + '-theme');
        })();
    </script>
    
    <!-- MathJax for rendering mathematical equations -->
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    
    <!-- Pace.js Loading Animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha512-QX7e4mJyMHH/RFYHtd4k9hfIDlNPFKjS5YdEWuVGqsZEZE5CjOJ7Vkiir/ZJcVVZr92J5bNGQiRGl1Wwy3oPQ==" crossorigin="anonymous"></script>
    
    <!-- Google Analytics -->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P0TDZ6WNVT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-P0TDZ6WNVT');
    </script>
</head>
<body class="{{ page.body_attr }}">
    <!-- Skip Links for Accessibility -->
    <div class="skip-links">
        <a href="#main-content" class="skip-link">Skip to main content</a>
        <a href="#navigation" class="skip-link">Skip to navigation</a>
    </div>
    
    {% include navbar.html %}
    <div class="container py-4">
        <main id="main-content" role="main" aria-label="Main content">
            {{content}}
        </main>
    </div>
    {% include footer.html %}

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.lazy/1.7.9/jquery.lazy.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js" integrity="sha512-XKa9Hemdy1Ui3KSGgJdgMyYlUg1gM+QhL6cnlyTe2qzMCYm4nAZ1PsVerQzTTXzonUR+dmswHqgJPuwCq1MaAg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/github-buttons/2.14.2/buttons.min.js" integrity="sha512-OYwZx04hKFeFNYrWBZs72X7T9U+NoHPM1ftUn/Mfw7dRDXrqWA6M1wBg6z6fGE32aeA==" crossorigin="anonymous"></script>
    
    <!-- Animation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js" integrity="sha512-A7AYk1fGKX6S2SsHywmPkrnzTZHrgiVT7GcQkLGDe2ev0aWb8zejytzS8wjo7PGEXKqJOrjQ4oORtnimIRZBtw==" crossorigin="anonymous"></script>
    
    <script src="{{ '/assets/js/performance-optimizations.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/common.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/tag-fix.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/theme-toggle.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/search.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/advanced-interactions.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/app-navigation.js' | relative_url }}"></script>
    
    <!-- Code Highlighting Enhancement -->
    <script src="{{ '/assets/js/code-highlight.js' | relative_url }}"></script>
    
    <!-- Mermaid.js for rendering diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            mermaid.initialize({
                startOnLoad: true,
                theme: 'dark',
                securityLevel: 'loose',
                themeVariables: {
                    primaryColor: '#bb2528',
                    primaryTextColor: '#ffffff',
                    primaryBorderColor: '#7C0000',
                    lineColor: '#F8B229',
                    secondaryColor: '#006100',
                    tertiaryColor: '#ffffff',
                    background: '#0d1117',
                    mainBkg: '#21262d',
                    secondBkg: '#30363d'
                }
            });
        });
    </script>
    
    <!-- Initialize AOS -->
    <script>
        AOS.init({
            duration: 600,
            easing: 'ease-in-out',
            once: true,
            offset: 20,
            delay: 100,
            disable: window.innerWidth < 768 ? 'mobile' : false,
            startEvent: 'DOMContentLoaded'
        });
    </script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js', {
                    scope: '/'
                }).then(function(registration) {
                    console.log('🚀 ServiceWorker registration successful:', registration.scope);
                    
                    // Check for updates
                    registration.addEventListener('updatefound', function() {
                        const newWorker = registration.installing;
                        console.log('🔄 New service worker found, installing...');
                        
                        newWorker.addEventListener('statechange', function() {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('✨ New content available, please refresh!');
                                showUpdateNotification();
                            }
                        });
                    });
                    
                }).catch(function(error) {
                    console.warn('❌ ServiceWorker registration failed:', error);
                });
                
                // Listen for messages from service worker
                navigator.serviceWorker.addEventListener('message', function(event) {
                    if (event.data && event.data.type === 'CACHE_UPDATED') {
                        console.log('📦 Cache updated successfully');
                    }
                });
            });
        }
        
        // Show update notification to user
        function showUpdateNotification() {
            // Create a subtle notification
            const notification = document.createElement('div');
            notification.className = 'alert alert-info position-fixed';
            notification.style.cssText = `
                top: 20px; 
                right: 20px; 
                z-index: 9999; 
                max-width: 300px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                border-radius: 8px;
                animation: slideInRight 0.3s ease-out;
            `;
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-sync-alt mr-2"></i>
                    <div class="flex-grow-1">
                        <strong>Update Available</strong><br>
                        <small>New content is ready!</small>
                    </div>
                    <button class="btn btn-sm btn-primary ml-2" onclick="window.location.reload()">
                        <i class="fas fa-redo mr-1"></i>Refresh
                    </button>
                    <button class="btn btn-sm btn-outline-secondary ml-1" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto-remove after 10 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 10000);
        }
        
        // Add install prompt for PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', function(e) {
            console.log('💾 PWA install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            showInstallBanner();
        });
        
        function showInstallBanner() {
            // Only show if not already installed
            if (!window.matchMedia('(display-mode: standalone)').matches) {
                const banner = document.createElement('div');
                banner.className = 'alert alert-success position-fixed d-flex align-items-center';
                banner.style.cssText = `
                    bottom: 20px; 
                    left: 20px; 
                    right: 20px; 
                    z-index: 9999;
                    margin: 0;
                    border-radius: 8px;
                    box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                    animation: slideInUp 0.3s ease-out;
                `;
                banner.innerHTML = `
                    <div class="flex-grow-1">
                        <i class="fas fa-mobile-alt mr-2"></i>
                        <strong>Install Portfolio App</strong>
                        <br><small>Add to your home screen for quick access!</small>
                    </div>
                    <button class="btn btn-success btn-sm ml-2" onclick="installPWA()">
                        <i class="fas fa-download mr-1"></i>Install
                    </button>
                    <button class="btn btn-outline-light btn-sm ml-1" onclick="this.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                
                document.body.appendChild(banner);
                
                // Auto-hide after 15 seconds
                setTimeout(() => {
                    if (banner.parentElement) {
                        banner.remove();
                    }
                }, 15000);
            }
        }
        
        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function(choiceResult) {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('🎉 User accepted the PWA install prompt');
                    } else {
                        console.log('😔 User dismissed the PWA install prompt');
                    }
                    deferredPrompt = null;
                });
                
                // Remove banner
                const banner = document.querySelector('.alert-success.position-fixed');
                if (banner) banner.remove();
            }
        }
        
        // Detect if app is running in standalone mode (installed PWA)
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone) {
            console.log('📱 Running as installed PWA');
            document.body.classList.add('pwa-mode');
        }
        
        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideInUp {
                from { transform: translateY(100%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            .pwa-mode .navbar {
                padding-top: env(safe-area-inset-top, 0);
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
