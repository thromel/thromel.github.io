---
layout: default
title: Open Source Contributions
navbar_title: Contributions
---

<!-- Page Header -->
<div class="section-header">
  <h2 class="section-title">Open Source Contributions</h2>
  <p class="section-subtitle">Pull requests and contributions to external repositories</p>
</div>

<!-- Stats Summary -->
<section class="section" style="margin-bottom: 2rem;">
  <div class="contributions-stats" id="contribution-stats">
    <div class="stat-card">
      <span class="stat-number" id="total-prs">-</span>
      <span class="stat-label">Pull Requests</span>
    </div>
    <div class="stat-card">
      <span class="stat-number" id="merged-prs">-</span>
      <span class="stat-label">Merged</span>
    </div>
    <div class="stat-card">
      <span class="stat-number" id="repos-contributed">-</span>
      <span class="stat-label">Repositories</span>
    </div>
  </div>
</section>

<!-- Loading State -->
<div id="loading-state" class="loading-container">
  <div class="loading-spinner"></div>
  <p>Fetching contributions from GitHub...</p>
</div>

<!-- Error State -->
<div id="error-state" class="error-container" style="display: none;">
  <i class="fas fa-exclamation-triangle"></i>
  <p>Unable to fetch contributions. Please try again later.</p>
  <button onclick="fetchContributions()" class="btn btn-secondary">Retry</button>
</div>

<!-- Contributions Timeline -->
<section class="section" id="contributions-section" style="display: none;">
  <div class="timeline" id="contributions-timeline">
    <!-- Contributions will be dynamically inserted here -->
  </div>
</section>

<!-- Empty State -->
<div id="empty-state" class="empty-container" style="display: none;">
  <i class="fas fa-code-branch"></i>
  <p>No external contributions found yet.</p>
</div>

<style>
.contributions-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: var(--space-4);
  margin-bottom: var(--space-6);
}

.stat-card {
  background: var(--glass-bg);
  border: 1px solid var(--glass-border);
  border-radius: 8px;
  padding: var(--space-6);
  text-align: center;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.stat-card:hover {
  transform: translateY(-2px);
  border-color: var(--accent-primary);
}

.stat-number {
  display: block;
  font-size: var(--font-size-3xl);
  font-weight: 700;
  color: var(--accent-primary);
  margin-bottom: var(--space-2);
}

.stat-label {
  font-size: var(--font-size-sm);
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.loading-container,
.error-container,
.empty-container {
  text-align: center;
  padding: var(--space-12);
  color: var(--text-muted);
}

.loading-spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--glass-border);
  border-top-color: var(--accent-primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto var(--space-4);
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.error-container i,
.empty-container i {
  font-size: 2.5rem;
  margin-bottom: var(--space-4);
  color: var(--text-muted);
}

.error-container i {
  color: #ef4444;
}

.contribution-item {
  position: relative;
}

.contribution-repo {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--font-size-sm);
  color: var(--text-secondary);
  margin-bottom: var(--space-2);
}

.contribution-repo i {
  color: var(--accent-primary);
}

.pr-status {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: var(--font-size-xs);
  font-weight: 500;
}

.pr-status.merged {
  background: rgba(139, 92, 246, 0.15);
  color: #a78bfa;
}

.pr-status.open {
  background: rgba(34, 197, 94, 0.15);
  color: #4ade80;
}

.pr-status.closed {
  background: rgba(239, 68, 68, 0.15);
  color: #f87171;
}

.contribution-labels {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
  margin-top: var(--space-3);
}

.contribution-label {
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
  font-size: var(--font-size-xs);
  background: var(--bg-tertiary);
  color: var(--text-secondary);
}

.contribution-meta {
  display: flex;
  align-items: center;
  gap: var(--space-4);
  margin-top: var(--space-3);
  font-size: var(--font-size-sm);
  color: var(--text-muted);
}

.contribution-meta a {
  color: var(--accent-primary);
  text-decoration: none;
}

.contribution-meta a:hover {
  text-decoration: underline;
}
</style>

<script>
const GITHUB_USERNAME = '{{ site.data.profile.github | default: "thromel" }}';

async function fetchContributions() {
  const loadingState = document.getElementById('loading-state');
  const errorState = document.getElementById('error-state');
  const emptyState = document.getElementById('empty-state');
  const contributionsSection = document.getElementById('contributions-section');
  const timeline = document.getElementById('contributions-timeline');

  // Show loading, hide others
  loadingState.style.display = 'block';
  errorState.style.display = 'none';
  emptyState.style.display = 'none';
  contributionsSection.style.display = 'none';

  try {
    // Fetch PRs authored by user to other repositories
    const response = await fetch(
      `https://api.github.com/search/issues?q=author:${GITHUB_USERNAME}+type:pr+-user:${GITHUB_USERNAME}&sort=updated&order=desc&per_page=50`,
      {
        headers: {
          'Accept': 'application/vnd.github.v3+json'
        }
      }
    );

    if (!response.ok) {
      throw new Error('GitHub API request failed');
    }

    const data = await response.json();
    const prs = data.items || [];

    loadingState.style.display = 'none';

    if (prs.length === 0) {
      emptyState.style.display = 'block';
      return;
    }

    // Update stats
    const mergedPRs = prs.filter(pr => pr.pull_request && pr.pull_request.merged_at);
    const uniqueRepos = new Set(prs.map(pr => pr.repository_url));

    document.getElementById('total-prs').textContent = prs.length;
    document.getElementById('merged-prs').textContent = mergedPRs.length;
    document.getElementById('repos-contributed').textContent = uniqueRepos.size;

    // Group PRs by repository
    const prsByRepo = {};
    prs.forEach(pr => {
      const repoName = pr.repository_url.replace('https://api.github.com/repos/', '');
      if (!prsByRepo[repoName]) {
        prsByRepo[repoName] = [];
      }
      prsByRepo[repoName].push(pr);
    });

    // Render contributions
    timeline.innerHTML = '';

    for (const [repoName, repoPRs] of Object.entries(prsByRepo)) {
      repoPRs.forEach(pr => {
        const date = new Date(pr.created_at);
        const formattedDate = date.toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'short',
          day: 'numeric'
        });

        // Determine PR status
        let status = 'open';
        let statusIcon = 'fa-code-pull-request';
        if (pr.pull_request && pr.pull_request.merged_at) {
          status = 'merged';
          statusIcon = 'fa-code-merge';
        } else if (pr.state === 'closed') {
          status = 'closed';
          statusIcon = 'fa-times-circle';
        }

        const itemHTML = `
          <div class="timeline-item contribution-item">
            <div class="contribution-repo">
              <i class="fab fa-github"></i>
              <a href="https://github.com/${repoName}" target="_blank">${repoName}</a>
            </div>
            <div class="timeline-header">
              <h3 class="timeline-title">
                <a href="${pr.html_url}" target="_blank">${escapeHtml(pr.title)}</a>
              </h3>
              <span class="timeline-date">${formattedDate}</span>
            </div>
            <div class="contribution-meta">
              <span class="pr-status ${status}">
                <i class="fas ${statusIcon}"></i>
                ${status.charAt(0).toUpperCase() + status.slice(1)}
              </span>
              <span>#${pr.number}</span>
              ${pr.comments > 0 ? `<span><i class="fas fa-comment"></i> ${pr.comments}</span>` : ''}
            </div>
            ${pr.labels && pr.labels.length > 0 ? `
              <div class="contribution-labels">
                ${pr.labels.map(label => `
                  <span class="contribution-label" style="background: #${label.color}20; color: #${label.color};">
                    ${escapeHtml(label.name)}
                  </span>
                `).join('')}
              </div>
            ` : ''}
          </div>
        `;

        timeline.insertAdjacentHTML('beforeend', itemHTML);
      });
    }

    contributionsSection.style.display = 'block';

  } catch (error) {
    console.error('Error fetching contributions:', error);
    loadingState.style.display = 'none';
    errorState.style.display = 'block';
  }
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// Fetch contributions on page load
document.addEventListener('DOMContentLoaded', fetchContributions);
</script>
